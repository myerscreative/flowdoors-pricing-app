---

name: "VibePoint Docs & AI Safety Protection"

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  validate-docs:
    name: "Validate Safety Docs and Markdown"
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Ensure required docs exist
        run: |
          REQUIRED_FILES=(
            "./docs/DEVELOPER_POLICY.md"
            "./docs/AI_BEHAVIOR_SPEC.md"
            "./docs/APP_STORE_SAFETY.md"
            "./docs/HOMEPAGE_EXPLANATION.md"
            "./docs/IMPLEMENTATION_GUIDE.md"
          )
          for f in "${REQUIRED_FILES[@]}"; do
            if [ ! -f "$f" ]; then
              echo "❌ ERROR: Required file missing: $f"
              exit 1
            fi
          done

      - name: Forbidden Keywords Scan
        run: |
          # Prevent accidental “therapy” or negative framing in system prompts
          FORBIDDEN=(
            "therapy"
            "mental illness"
            "diagnose"
            "clinical treatment"
            "commiserate"
            "validate negative feelings"
          )
          for word in "${FORBIDDEN[@]}"; do
            if grep -Ri "$word" docs/; then
              echo "❌ ERROR: Forbidden term '$word' found in documentation."
              exit 1
            fi
          done

      - name: Install markdownlint
        run: |
          npm install -g markdownlint-cli

      - name: Run markdownlint
        run: |
          markdownlint ./docs --ignore ".git"

      - name: Success message
        run: echo "✅ VibePoint safety docs validated successfully!"

---

